MASTER=$1
ssh student@$MASTER "
    CREATE_KEYSPACE_CMD='CREATE KEYSPACE IF NOT EXISTS urlshortener WITH replication = { '\''class'\'': '\''SimpleStrategy'\'', '\''replication_factor'\'': '\''2'\'' };'
    CREATE_TABLE_CMD='USE urlshortener; CREATE TABLE IF NOT EXISTS urls (shorturl text PRIMARY KEY, longurl text);'
    
    OUTPUT=\$(docker exec cassandra-node cqlsh -e \"\$CREATE_KEYSPACE_CMD\" 2>&1)
    EXIT_CODE=\$?
    echo \"\$OUTPUT\"
    if [ \$EXIT_CODE -ne 0 ]; then
        echo 'Failed to create keyspace.'
        exit 1
    fi
    
    OUTPUT=\$(docker exec cassandra-node cqlsh -e \"\$CREATE_TABLE_CMD\" 2>&1)
    EXIT_CODE=\$?
    echo \"\$OUTPUT\"
    if [ \$EXIT_CODE -ne 0 ]; then
        echo 'Failed to create table.'
        exit 1
    fi
    
    echo 'Keyspace and table created successfully.'
"